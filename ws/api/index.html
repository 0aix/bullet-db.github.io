<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../../favicon.ico">

    <title>API - Bullet</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">


    <link href="../../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Bullet</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../quick-start/">Quick Start</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Backend <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../backend/storm-architecture/">Storm Architecture</a>
</li>

                        
                            
<li >
    <a href="../../backend/ingestion/">Getting your data into Bullet</a>
</li>

                        
                            
<li >
    <a href="../../backend/setup-storm/">Setup on Storm</a>
</li>

                        
                            
<li >
    <a href="../../backend/performance/">Performance</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../setup/">Setup</a>
</li>

                        
                            
<li class="active">
    <a href="./">API</a>
</li>

                        
                            
<li >
    <a href="../examples/">Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UI <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../ui/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../ui/usage/">Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../about/releases/">Past Releases</a>
</li>

                        
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../../about/contact/">Contact Us</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../setup/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../examples/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/yahoo/bullet-docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#api">API</a></li>
        
            <li class="second-level"><a href="#querying">Querying</a></li>
            
                <li class="third-level"><a href="#filters">Filters</a></li>
            
                <li class="third-level"><a href="#projections">Projections</a></li>
            
                <li class="third-level"><a href="#aggregations">Aggregations</a></li>
            
                <li class="third-level"><a href="#results">Results</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="api">API</h1>
<p>See the <a href="../../ui/usage/">UI Usage section</a> for using the UI to build Bullet queries. This section deals with examples of the JSON query format that the API currently exposes (and the UI uses underneath).</p>
<h2 id="querying">Querying</h2>
<p>Bullet queries allow you to filter, project and aggregate data. It lets you fetch raw and aggregated data. Fields inside maps can be accessed using the '.' notation in queries. For example, myMap.key will access the key field inside the myMap map. There is no support for accessing fields inside Lists or inside nested Maps as of yet. Only the entire object can be operated on for now.</p>
<p>The three main sections of a Bullet query are:</p>
<pre><code class="javascript">{
    &quot;filters&quot;: {},
    &quot;projection&quot;: {},
    &quot;aggregation&quot;: {}.
    &quot;duration&quot;: 20000
}
</code></pre>

<p>The duration represents how long the query runs for (a window from when you submit it to that many milliseconds into the future). See the <a href="#filters">Filters</a>, <a href="#projections">Projections</a> and <a href="#aggregations">Aggregation</a> sections for their respective specifications. Each of those sections are objects.</p>
<h3 id="filters">Filters</h3>
<p>Bullet supports two kinds of filters:</p>
<ol>
<li>Logical filters</li>
<li>Relational filters</li>
</ol>
<h4 id="logical-filters">Logical Filters</h4>
<p>Logical filters allow you to combine other filter clauses with logical operations like AND, OR and NOT.</p>
<p>The current logical operators allowed in filters are:</p>
<table>
<thead>
<tr>
<th>Logical Operator</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>AND</td>
<td>All filters must be true. The first false filter evaluated left to right will short-circuit the computation.</td>
</tr>
<tr>
<td>OR</td>
<td>Any filter must be true. The first true filter evaluated left to right will short-circuit the computation.</td>
</tr>
<tr>
<td>NOT</td>
<td>Negates the value of the first filter clause. The filter is satisfied iff the value is true.</td>
</tr>
</tbody>
</table>
<p>The format for a Logical filter is:</p>
<pre><code class="javascript">{
   &quot;operation&quot;: &quot;AND | OR | NOT&quot;
   &quot;clauses&quot;: [
      {&quot;operation&quot;: &quot;...&quot;, clauses: [{}, ...]},
      {&quot;field&quot;: &quot;...&quot;, &quot;operation&quot;: &quot;&quot;, values: [&quot;...&quot;]},
      {&quot;operation&quot;: &quot;...&quot;, clauses: [{}, ...]}
      ...
   ]
}
</code></pre>

<p>Any other type of filter may be provided as a clause in clauses.</p>
<h4 id="relational-filters">Relational Filters</h4>
<p>Relational filters allow you to specify conditions on a field, using a comparison operator and a list of values.</p>
<p>The current comparisons allowed in filters are:</p>
<table>
<thead>
<tr>
<th>Comparison</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>Equal to any value in values</td>
</tr>
<tr>
<td>!=</td>
<td>Not equal to any value in values</td>
</tr>
<tr>
<td>&lt;=</td>
<td>Less than or equal to any value in values</td>
</tr>
<tr>
<td>&gt;=</td>
<td>Greater than or equal to any value in values</td>
</tr>
<tr>
<td>&lt;</td>
<td>Less than any value in values</td>
</tr>
<tr>
<td>&gt;</td>
<td>Greater than any value in values</td>
</tr>
<tr>
<td>RLIKE</td>
<td>Matches using <a href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Java Regex notation</a>, any Regex value in values</td>
</tr>
</tbody>
</table>
<p>These operators are all typed based on the type of the left hand side from the Bullet record. If the elements on the right hand side cannot be
casted to the types on the LHS, those items will be ignored for the comparison.</p>
<p>The format for a Relational filter is:</p>
<pre><code class="javascript">{
    &quot;operation&quot;: &quot;== | != | &lt;= | &gt;= | &lt; | &gt; | RLIKE&quot;
    &quot;field&quot;: &quot;record_field_name | map_field.subfield&quot;,
    &quot;values&quot;: [
        &quot;string values&quot;,
        &quot;that go here&quot;,
        &quot;will be casted&quot;,
        &quot;to the&quot;,
        &quot;type of field&quot;
    ]
}
</code></pre>

<p><em>Multiple top level relational filters behave as if they are ANDed together.</em></p>
<h3 id="projections">Projections</h3>
<p>Projections allow you to pull out only the fields needed and rename them (renaming is being supported in order to give
better names to fields pulled out from maps). If projections are not specified, the entire record is returned. If you are querying
for raw records, you can use projections to help reduce the load on the system and network.</p>
<pre><code class="javascript">{
    &quot;projection&quot;: {
        &quot;fieldA&quot;: &quot;newNameA&quot;,
        &quot;fieldB&quot;: &quot;newNameB&quot;
    }
}
</code></pre>

<h3 id="aggregations">Aggregations</h3>
<p>Aggregations allow you to perform some operation on the collected records. They take an optional size to restrict
the size of the aggregation (this applies for aggregations high cardinality aggregations and raw records).</p>
<p>The current aggregation types that are supported are:</p>
<table>
<thead>
<tr>
<th>Aggregation</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>GROUP</td>
<td>The resulting output would be a record containing the result of an operation for each unique group in the specified fields</td>
</tr>
<tr>
<td>COUNT DISTINCT</td>
<td>Computes the number of distinct elements in the fields. (May be approximate)</td>
</tr>
<tr>
<td>LIMIT</td>
<td>The resulting output would be at most the number specified in size.</td>
</tr>
</tbody>
</table>
<p>The current format for an aggregation is (<strong>note see above for what is supported at the moment</strong>):</p>
<pre><code class="javascript">{
    &quot;type&quot;: &quot;GROUP | COUNT DISTINCT | TOP | PERCENTILE | RAW&quot;,
    &quot;size&quot;: &lt;a limit on the number of resulting records&gt;,
    &quot;fields&quot;: {
        &quot;fields&quot;: &quot;newNameA&quot;,
        &quot;that go here&quot;: &quot;newNameB&quot;,
        &quot;are what the&quot;: &quot;newNameC&quot;,
        &quot;aggregation type applies to&quot;: &quot;newNameD&quot;
    },
    &quot;attributes&quot;: {
        &quot;these&quot;: &quot;change&quot;,
        &quot;per&quot;: [
           &quot;aggregation type&quot;
        ]
    }
}
</code></pre>

<p>You can also use LIMIT as an alias for RAW. DISTINCT is also an alias for GROUP. These exist to make some queries read a bit better.</p>
<p>Currently we support GROUP aggregations on the following operations:</p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>COUNT</td>
<td>Computes the number of the elements in the group</td>
</tr>
<tr>
<td>SUM</td>
<td>Computes the sum of the elements in the group</td>
</tr>
<tr>
<td>MIN</td>
<td>Returns the minimum of the elements in the group</td>
</tr>
<tr>
<td>MAX</td>
<td>Returns the maximum of the elements in the group</td>
</tr>
<tr>
<td>AVG</td>
<td>Computes the average of the elements in the group</td>
</tr>
</tbody>
</table>
<p>The following attributes are supported for GROUP:</p>
<p>Attributes for GROUP:</p>
<pre><code class="javascript">    &quot;attributes&quot;: {
        &quot;operations&quot;: [
            {
                &quot;type&quot;: &quot;COUNT&quot;,
                &quot;newName&quot;: &quot;resultColumnName&quot;
            },
            {
                &quot;type&quot;: &quot;SUM&quot;,
                &quot;field&quot;: &quot;fieldName&quot;,
                &quot;newName&quot;: &quot;resultColumnName&quot;
            },
            {
                &quot;type&quot;: &quot;MIN&quot;,
                &quot;field&quot;: &quot;fieldName&quot;,
                &quot;newName&quot;: &quot;resultColumnName&quot;
            },
            {
                &quot;type&quot;: &quot;MAX&quot;,
                &quot;field&quot;: &quot;fieldName&quot;,
                &quot;newName&quot;: &quot;resultColumnName&quot;
            },
            {
                &quot;type&quot;: &quot;AVG&quot;,
                &quot;field&quot;: &quot;fieldName&quot;,
                &quot;newName&quot;: &quot;resultColumnName&quot;
            }
        ]
    }
</code></pre>

<p>You can perform SUM, MIN, MAX, AVG on non-numeric fields. <strong>Bullet will attempt to cast the field to a number first.</strong> If it cannot, that record with the field will be ignored for the operation. For the purposes of AVG, Bullet will
perform the average across the numeric values for a field only.</p>
<p>Attributes for COUNT DISTINCT:</p>
<pre><code class="javascript">    &quot;attributes&quot;: {
        &quot;newName&quot;: &quot;the name of the resulting count column&quot;
    }
</code></pre>

<p>Note that the new names you specify in the fields map for aggregations do not apply. You must use the attributes here to give your resulting output count column a name.</p>
<p>See the <a href="#examples">examples section</a> for a detailed description of how to perform these aggregations.</p>
<h3 id="results">Results</h3>
<p>Bullet results are JSON objects with two fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td>records</td>
<td>This field contains the list of matching records</td>
</tr>
<tr>
<td>meta</td>
<td>This field is a map that contains meta information about the query, such as the time the query was received, error data, etc. These are configurable at launch time.</td>
</tr>
</tbody>
</table>
<p>For example queries and results, see <a href="../examples/">Examples</a>.</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Bullet is licensed under the <a href='https://github.com/yahoo/bullet/blob/master/LICENSE'>Apache 2 license<br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
