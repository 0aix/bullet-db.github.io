<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../../favicon.ico">

    <title>Setup - Bullet</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">


    <link href="../../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Bullet</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../quick-start/">Quick Start</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Backend <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../backend/storm-architecture/">Storm Architecture</a>
</li>

                        
                            
<li >
    <a href="../../backend/ingestion/">Getting your data into Bullet</a>
</li>

                        
                            
<li >
    <a href="../../backend/setup-storm/">Setup on Storm</a>
</li>

                        
                            
<li >
    <a href="../../backend/performance/">Performance</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">Setup</a>
</li>

                        
                            
<li >
    <a href="../api/">API</a>
</li>

                        
                            
<li >
    <a href="../examples/">Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UI <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../ui/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../ui/usage/">Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../about/releases/">Releases</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../../backend/performance/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../api/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/yahoo/bullet-docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#the-web-service">The Web Service</a></li>
        
            <li class="second-level"><a href="#prerequisites">Prerequisites</a></li>
            
        
            <li class="second-level"><a href="#installation">Installation</a></li>
            
        
            <li class="second-level"><a href="#configuration">Configuration</a></li>
            
                <li class="third-level"><a href="#file-based-schema">File based schema</a></li>
            
        
            <li class="second-level"><a href="#launch">Launch</a></li>
            
                <li class="third-level"><a href="#quick-start-with-jetty">Quick start with Jetty</a></li>
            
        
            <li class="second-level"><a href="#usage">Usage</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="the-web-service">The Web Service</h1>
<p>The Web Service is a Java WAR file that you can deploy on a machine to communicate with the Bullet Backend. For Storm, it talks to the Storm DRPC servers. To set up the Bullet backend topology, see <a href="../../backend/setup-storm/">Storm setup</a>.</p>
<p>There are two main purposes for this layer at this time:</p>
<p>1) It provides an endpoint that can serve a <a href="http://jsonapi.org/format/">JSON API schema</a> for the Bullet UI. Currently, static schemas from a file are supported.</p>
<p>2) It proxies a JSON Bullet query to Bullet and wraps errors if the backend is unreachable.</p>
<div class="admonition note">
<p class="admonition-title">That's it?</p>
<p>The Web Service essentially just wraps Storm DRPC and provides some helpful endpoints. But the Web Service is there to be a point of abstraction for implementing things like security, monitoring, access-control, rate-limiting, different query formats (e.g. SQL Bullet queries) etc, which are planned in the near future.</p>
</div>
<h2 id="prerequisites">Prerequisites</h2>
<p>In order for your Web Service to work with Bullet, you should have an instance of the <a href="../../backend/setup-storm/">backend</a> already set up.</p>
<h2 id="installation">Installation</h2>
<p>You can download the WAR file directly from <a href="http://jcenter.bintray.com/com/yahoo/bullet/bullet-service/">JCenter</a>.</p>
<p>If you need to depend on the source code directly for any reason, you need to add the JCenter repository and get the artifact through your dependency management system. Maven is shown below.</p>
<pre><code class="xml">&lt;repositories&gt;
    &lt;repository&gt;
        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
        &lt;/snapshots&gt;
        &lt;id&gt;central&lt;/id&gt;
        &lt;name&gt;bintray&lt;/name&gt;
        &lt;url&gt;http://jcenter.bintray.com&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre>

<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.yahoo.bullet&lt;/groupId&gt;
  &lt;artifactId&gt;bullet-service&lt;/artifactId&gt;
  &lt;version&gt;${bullet.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>You can also add <code>&lt;classifier&gt;sources&lt;/classifier&gt;</code>  or <code>&lt;classifier&gt;javadoc&lt;/classifier&gt;</code> if you want the source or javadoc.</p>
<h2 id="configuration">Configuration</h2>
<p>You specify how to talk to your Bullet instance and where to find your schema file (optional for if you want to power the <a href="../../ui/usage/">UI</a> schema with a static file) through a configuration file. See sample at <a href="../src/main/resources/bullet_defaults.yaml">bullet_defaults.yaml</a>.</p>
<p>The values in the defaults file are used for any missing properties. You can specify a path to your custom configuration using the property:</p>
<pre><code class="bash">bullet.service.configuration.file=&lt;path to your configuration file&gt;
</code></pre>

<p>For example, if you are using Jetty as your servlet container,</p>
<pre><code class="bash">java -jar -Dbullet.service.configuration.file=/var/bullet-service/context.properties start.jar
</code></pre>

<div class="admonition note">
<p class="admonition-title">Spring and context</p>
<p>The Web Service uses your passed in configuration properties file to configure its dependency injections using <a href="http://spring.io/">Spring</a>. See <a href="https://github.com/yahoo/bullet-service/blob/master/src/main/resources/ApplicationContext.xml">ApplicationContext.xml</a> for how this is loaded.</p>
</div>
<h3 id="file-based-schema">File based schema</h3>
<p>The Web Service can also provide a endpoint that serves your data schema to your UI. You do not necessarily have to use this to serve your schema. The UI can use any JSON API schema specification. But if your schema is fixed or does not change often, it might be simpler for you to use this endpoint to provide the schema for the UI, instead of creating a new one. The Web Service also takes care to provide the right <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">CORS</a> headers so that your UI can communicate with it.</p>
<p>You can use <a href="https://github.com/yahoo/bullet-service/blob/master/src/main/resources/sample_columns.json">sample_columns.json</a> as a guideline for what your actual schema file should look like or if you want to create your own Web Service that dynamically serves your schema to the UI if it changes frequently.</p>
<h2 id="launch">Launch</h2>
<p>You need to deploy the WAR file to a servlet container. We recommend <a href="http://www.eclipse.org/jetty/">Jetty</a>.</p>
<h3 id="quick-start-with-jetty">Quick start with Jetty</h3>
<ol>
<li>Download a <a href="http://www.eclipse.org/jetty/download.html">Jetty installation</a></li>
<li>Unarchive the installation into a folder</li>
<li>Download the Bullet Service WAR from <a href="http://jcenter.bintray.com/com/yahoo/bullet/bullet-service/">JCenter</a>.</li>
<li>Place the WAR into your Jetty installation folder's <code>webapps</code> directory.</li>
<li>Create a properties file containing actual values for the settings in the <a href="https://github.com/yahoo/bullet-service/blob/master/src/main/resources/default.properties">defaults</a>. For example, for Bullet on Storm, you will point to your DRPC servers in the properties. If you want to use the file based schema endpoint, you would point to your schema file.</li>
<li>Launch Jetty using <code>java -jar -Dbullet.service.configuration.file=/path/to/your/properties/file start.jar</code>, where start.jar is in your Jetty installation folder.</li>
</ol>
<p>You should tweak and properly install Jetty into a global location with proper logging when you productionize your Web Service.</p>
<h2 id="usage">Usage</h2>
<p>Once the Web Service is up (defaults to port 8080, you can change it with a <code>-Djetty.http.port=&lt;PORT&gt;</code> setting), you should be able to test to see if it's able to talk to the Bullet backend:</p>
<p>You can HTTP POST a Bullet query to the API with:</p>
<pre><code class="bash">curl -s -H &quot;Content-Type: application/json&quot; -X POST -d '{}' http://localhost:8080/bullet-service/api/drpc
</code></pre>

<p>You should receive a random record flowing through Bullet instantly (if you left the Raw aggregation micro-batch size at the default of 1 when launching the Bullet backend).</p>
<div class="admonition note">
<p class="admonition-title">Context Path</p>
<p>The context path, or "bullet-service" in the URL above is the name of the WAR file in Jetty. If you rename it, you will need to change this.</p>
</div>
<p>If you provided a path to a schema file in your configuration file when you <a href="#launch">launch</a> the Web Service, you can also HTTP GET your schema at <code>http://localhost:8080/bullet-service/api/columns</code></p>
<p>If you did not, the schema in <a href="https://github.com/yahoo/bullet-service/blob/master/src/main/resources/sample_columns.json">sample_columns.json</a> is the response. The Web Service converts it to a JSON API response and provides the right headers for CORS.</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Bullet is licensed under the <a href='https://github.com/yahoo/bullet/blob/master/LICENSE'>Apache 2 license<br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
