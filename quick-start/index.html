<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Quick Start - Bullet</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    

    
    
      
    
    
    <style>
        /* Collapse ToC */
        .bs-sidebar .nav .nav {
            display: none;
        }
    </style>
    
</head>

<body data-spy="scroll" data-target=".bs-sidebar">

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">Bullet<small class="small small-brand-text"></small></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Quick Start</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Backend <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../backend/storm-architecture/">Storm Architecture</a>
</li>

                        
                            
<li >
    <a href="../backend/ingestion/">Getting your data into Bullet</a>
</li>

                        
                            
<li >
    <a href="../backend/setup-storm/">Setup on Storm</a>
</li>

                        
                            
<li >
    <a href="../backend/performance/">Performance</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../ws/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../ws/api/">API</a>
</li>

                        
                            
<li >
    <a href="../ws/examples/">Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UI <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../ui/setup/">Setup</a>
</li>

                        
                            
<li >
    <a href="../ui/usage/">Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../about/releases/">Past Releases</a>
</li>

                        
                            
<li >
    <a href="../about/contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../about/contact/">Contact Us</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                
                    <li >
                        <a rel="next" href="..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../backend/storm-architecture/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/yahoo/bullet-docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3">

  

<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="active">
            <a href="#quick-start">Quick Start</a>
            <ul class="nav">
                
                    <li class="second-level">
                        <a href="#setting-up-storm">Setting up Storm</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#step-1-setup-directories-and-examples">Step 1: Setup directories and examples</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-2-install-storm-10">Step 2: Install Storm 1.0</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-3-launch-storm-components">Step 3: Launch Storm components</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-4-test-storm-optional">Step 4: Test Storm (Optional)</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
                    <li class="second-level">
                        <a href="#setting-up-the-example-bullet-topology">Setting up the example Bullet topology</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#step-5-build-the-storm-example">Step 5: Build the Storm example</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-6-launch-the-topology">Step 6: Launch the topology</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
                    <li class="second-level">
                        <a href="#setting-up-the-bullet-web-service">Setting up the Bullet Web Service</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#step-7-install-jetty">Step 7: Install Jetty</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-8-install-the-bullet-web-service">Step 8: Install the Bullet Web Service</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-9-launch-the-web-service">Step 9: Launch the Web Service</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
                    <li class="second-level">
                        <a href="#setting-up-the-bullet-ui">Setting up the Bullet UI</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#step-10-install-node">Step 10: Install Node</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-11-install-the-bullet-ui">Step 11: Install the Bullet UI</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#step-12-launch-the-ui">Step 12: Launch the UI</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
                    <li class="second-level">
                        <a href="#what-did-we-do">What did we do?</a>
                        <ul class="nav">
                        
                            <li class="third-level">
                                <a href="#storm-topology">Storm topology</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#web-service">Web Service</a>
                                
                            </li>
                        
                            <li class="third-level">
                                <a href="#ui">UI</a>
                                
                            </li>
                        
                        </ul>
                    </li>
            
            </ul>
        </li>
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="quick-start">Quick Start</h1>
<p>This section gets you up and running with an mock instance of Bullet to play around with. The instance will be running using <a href="../backend/setup-storm/">Bullet on Storm</a>. Since we do not have an actual data source, we will produce some fake data and convert it into <a href="../backend/ingestion/">Bullet Records</a> in a
<a href="https://github.com/yahoo/bullet-docs/blob/master/examples/storm/src/main/java/com/yahoo/bullet/storm/examples/RandomSpout.java">custom Storm spout</a>. When you build Bullet for your data, you will need to do something similar after reading your data.</p>
<p>At the end of this section, you should have a full end-to-end Bullet instance with a Web Service and UI running on a machine. You will:</p>
<ul>
<li>Setup the Bullet topology using a custom spout on <a href="https://github.com/yahoo/bullet-storm/releases/tag/bullet-storm-0.3.0">bullet-storm-0.3.0</a></li>
<li>Setup the <a href="../ws/setup/">Web Service</a> talking to the topology and serving a schema for your UI using <a href="https://github.com/yahoo/bullet-service/releases/tag/bullet-service-0.0.1">bullet-service-0.0.1</a></li>
<li>Setup the <a href="../ui/setup/">UI</a> talking to the Web Service using <a href="https://github.com/yahoo/bullet-ui/releases/tag/v0.1.0">bullet-ui-0.1.0</a></li>
</ul>
<p>Prerequisites:</p>
<ul>
<li>You will need to be on an Unix-based system (Mac, Ubuntu ...) for most of these commands.</li>
<li>You will need enough CPU and RAM on your machine to run about about 8-10 JVMs. You will be setting up a Storm cluster with multiple components, a couple of Jetty instances and a Node server.</li>
<li>You will need <a href="https://git-scm.com/downloads">git</a>, <a href="https://maven.apache.org/install.html">Maven 3</a> and <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK 8</a> installed. The example will walk you through installing <a href="http://nodejs.org">Node.js</a>.</li>
</ul>
<h2 id="setting-up-storm">Setting up Storm</h2>
<p>This section will deal with setting up Storm. To set up a clean working environment, start with creating an empty working directory.</p>
<h4 id="step-1-setup-directories-and-examples">Step 1: Setup directories and examples</h4>
<pre><code class="bash">export BULLET_HOME=$(pwd)/bullet-quickstart
mkdir -p $BULLET_HOME/backend/storm
mkdir -p $BULLET_HOME/service
mkdir -p $BULLET_HOME/ui
cd $BULLET_HOME &amp;&amp; git clone git@github.com:yahoo/bullet-docs.git
export BULLET_EXAMPLES=$BULLET_HOME/bullet-docs/examples
</code></pre>

<h4 id="step-2-install-storm-10">Step 2: Install Storm 1.0</h4>
<pre><code class="bash">cd $BULLET_HOME/backend
wget http://apache.org/dist/storm/apache-storm-1.0.3/apache-storm-1.0.3.zip
unzip apache-storm-1.0.3.zip
export PATH=$(pwd)/apache-storm-1.0.3/bin/:$PATH
</code></pre>

<p>Add a DRPC server setting to the Storm config:</p>
<pre><code class="bash">echo 'drpc.servers: [&quot;127.0.0.1&quot;]' &gt;&gt; apache-storm-1.0.3/conf/storm.yaml
</code></pre>

<h4 id="step-3-launch-storm-components">Step 3: Launch Storm components</h4>
<p>Launch each of the following components, in order and wait for the commands to go through. You will see a JVM being launched:</p>
<pre><code class="bash">storm dev-zookeeper &amp;
storm nimbus &amp;
storm drpc &amp;
storm ui &amp;
storm logviewer &amp;
storm supervisor &amp;
</code></pre>

<p>Once everything is up without errors, visit localhost:8080 and see if the Storm UI loads.</p>
<h4 id="step-4-test-storm-optional">Step 4: Test Storm (Optional)</h4>
<p>Before Bullet, test to see if Storm and DRPC are up and running by launching a example topology that comes with your Storm installation:</p>
<pre><code class="bash">storm jar apache-storm-1.0.3/examples/storm-starter/storm-starter-topologies-1.0.3.jar org.apache.storm.starter.BasicDRPCTopology topology
</code></pre>

<p>Visit your UI with a browser and see if a topology with name "topology" is running. If everything is good, you should be able to ping DRPC with:</p>
<pre><code class="bash">curl localhost:3774/drpc/exclamation/foo
</code></pre>

<p>and get back a <code>foo!</code>. Any string you pass as part of the URL is returned to you with a "!" at the end.</p>
<p>Kill this topology after with:</p>
<pre><code class="bash">storm kill topology
</code></pre>

<div class="admonition note">
<p class="admonition-title">Local mode cleanup</p>
<p>If you notice any problems while setting up storm or while relaunching a topology, it may be because some state is corrupted. When running Storm in this fashion, states and serializations are stored in <code>storm-local</code>. You may want to <code>rm -rf storm-local/*</code> to remove everything in this directory before relaunching Storm components.</p>
</div>
<h2 id="setting-up-the-example-bullet-topology">Setting up the example Bullet topology</h2>
<p>Now that Storm is up and running, we can put Bullet on it. We will build an example Spout that runs on Bullet 0.3.0 on our Storm cluster. The source is available <a href="https://github.com/yahoo/bullet-docs/blob/master/examples/storm">here</a>.</p>
<h4 id="step-5-build-the-storm-example">Step 5: Build the Storm example</h4>
<pre><code class="bash">cd $BULLET_EXAMPLES/storm &amp;&amp; mvn package
cp $BULLET_EXAMPLES/storm/bin/launch.sh $BULLET_HOME/backend/storm
cp $BULLET_EXAMPLES/storm/target/*jar-with-dependencies.jar $BULLET_HOME/backend/storm
cp $BULLET_EXAMPLES/storm/src/main/resources/bullet_settings.yaml $BULLET_HOME/backend/storm
</code></pre>

<div class="admonition note">
<p class="admonition-title">Settings</p>
<p>Take a look at bullet_settings.yaml for the settings that are being overridden for this example. You can add or change settings as you like by referring to <a href="https://github.com/yahoo/bullet-storm/blob/master/src/main/resources/bullet_defaults.yaml">bullet_defaults.yaml</a>.</p>
</div>
<h4 id="step-6-launch-the-topology">Step 6: Launch the topology</h4>
<pre><code class="bash">cd $BULLET_HOME/backend/storm &amp;&amp; ./launch.sh
</code></pre>

<p>This script also kills any existing Bullet instances running (you may see an ignorable exception if there is nothing running). There can only be one topology in the cluster with a particular name. Visit the UI and see if the topology is up. You should see the <code>DataSource</code> spout begin emitting records.</p>
<p>Test the Bullet topology by:</p>
<pre><code class="bash">curl -s -X POST -d '{}' http://localhost:3774/drpc/bullet
</code></pre>

<p>You should get a random record from Bullet produced by the custom spout that we plugged in.</p>
<h2 id="setting-up-the-bullet-web-service">Setting up the Bullet Web Service</h2>
<h4 id="step-7-install-jetty">Step 7: Install Jetty</h4>
<pre><code class="bash">cd $BULLET_HOME/service
wget http://central.maven.org/maven2/org/eclipse/jetty/jetty-distribution/9.3.16.v20170120/jetty-distribution-9.3.16.v20170120.zip
unzip jetty-distribution-9.3.16.v20170120.zip
</code></pre>

<h4 id="step-8-install-the-bullet-web-service">Step 8: Install the Bullet Web Service</h4>
<pre><code class="bash">cd jetty-distribution-9.3.16.v20170120
wget -O webapps/bullet-service.war http://jcenter.bintray.com/com/yahoo/bullet/bullet-service/0.0.1/bullet-service-0.0.1.war
cp $BULLET_EXAMPLES/web-service/example_* $BULLET_HOME/service/jetty-distribution-9.3.16.v20170120
</code></pre>

<h4 id="step-9-launch-the-web-service">Step 9: Launch the Web Service</h4>
<pre><code class="bash">cd $BULLET_HOME/service/jetty-distribution-9.3.16.v20170120
java -jar -Dbullet.service.configuration.file=&quot;example_context.properties&quot; -Djetty.http.port=9999 start.jar &gt; logs/out 2&gt;&amp;1 &amp;
</code></pre>

<p>You can verify that it is up by running the Bullet query and getting the example_columns through the API:</p>
<pre><code class="bash">curl -s -X POST -d '{}' http://localhost:9999/bullet-service/api/drpc
curl -s http://localhost:9999/bullet-service/api/columns
</code></pre>

<h2 id="setting-up-the-bullet-ui">Setting up the Bullet UI</h2>
<h4 id="step-10-install-node">Step 10: Install Node</h4>
<pre><code class="bash">wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.1/install.sh | bash
source ~/.bashrc
nvm install v6.9.4
nvm use v6.9.4
</code></pre>

<h4 id="step-11-install-the-bullet-ui">Step 11: Install the Bullet UI</h4>
<pre><code class="bash">cd $BULLET_HOME/ui
wget https://github.com/yahoo/bullet-ui/releases/download/v0.1.0/bullet-ui-v0.1.0.tar.gz
tar -xzf bullet-ui-v0.1.0.tar.gz
cp $BULLET_EXAMPLES/ui/env-settings.json config/
</code></pre>

<h4 id="step-12-launch-the-ui">Step 12: Launch the UI</h4>
<pre><code class="bash">PORT=8800 node express-server.js &amp;
</code></pre>

<p>Visit http://localhost:8800 to query your topology with the UI. See <a href="../ui/usage/">UI usage</a> for some example queries and interactions using this UI. You see what the Schema means by visiting the Schema section.</p>
<div class="admonition note">
<p class="admonition-title">Running it remotely?</p>
<p>If you access the UI from another machine than where your UI is actually running, you will need to edit <code>config/env-settings.json</code>. Since the UI is a client-side app, the machine that your browser is running on will fetch the UI and attempt to use these settings to talk to the Web Service. Since they point to localhost by default, your browser will attempt to connect there and fail. An easy fix is to change <code>localhost</code> in your env-settings.json to point to the hostname where you will hosting the UI. This will be same UI you use in the browser.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Bringing it all down</p>
<p>To kill the Bullet topology, run <code>storm kill bullet</code></p>
<p>To kill the UI, run <code>ps aux | grep [e]xpress-server | awk '{print $2}' | xargs kill</code></p>
<p>To kill the Web Service, run <code>ps aux | grep [e]xample_context | awk '{print $2}' | xargs kill</code></p>
<p>To kill Storm, run <code>ps aux | grep [a]pache-storm-1.0.3 | awk '{print $2}' | xargs kill</code></p>
</div>
<h2 id="what-did-we-do">What did we do?</h2>
<p>This section will cover the various custom pieces this example plugged into Bullet, so you can better understand what we did.</p>
<h3 id="storm-topology">Storm topology</h3>
<p>The topology was the Bullet topology plugged in with a custom spout. This spout is implemented in this <a href="https://github.com/yahoo/bullet-docs/blob/master/examples/storm/">example project</a> you built from source. This spout produces a maximum number of records in a given period. Both these arguments are configurable. If you examine $BULLET_HOME/backend/storm/launch.sh, you'll see the following:</p>
<pre><code class="bash">storm jar bullet-storm-example-1.0-SNAPSHOT-jar-with-dependencies.jar \
          com.yahoo.bullet.Topology \
          --bullet-conf bullet_settings.yaml \
          --bullet-spout com.yahoo.bullet.storm.examples.RandomSpout \
          --bullet-spout-parallelism 1 \
          ...
          --bullet-spout-arg 20 \
          --bullet-spout-arg 100 \
          ...
</code></pre>

<p>This command launches the jar (an uber or "fat" jar) containing the custom spout code and all dependencies you built in Step 5. We pass the name of your spout class with <code>--bullet-spout com.yahoo.bullet.storm.examples.RandomSpout</code> to the Bullet main class <code>com.yahoo.bullet.Topology</code> with two arguments <code>--bullet-spout-arg 20</code> and <code>--bullet-spout-arg 100</code>. The first argument tells the Spout to generate at most 20 tuples in a period and the second argument says a period is 100 ms long.</p>
<p>The settings defined by <code>--bullet-conf bullet_settings.yaml</code> and the arguments here run all components in the topology with a parallelism of 1. So there will be one spout that is producing 200 tuples per second.</p>
<div class="admonition note">
<p class="admonition-title">I thought you said hundreds of thousands of records...</p>
<p>200 tuples/s is not Big Data by any stretch of the imagination but this Quick Start is running everything on one machine and is meant to introduce you to what Bullet does. In practice, you would scale and run your components to accommodate for your data volume and querying needs.</p>
</div>
<p>Let's look at the <a href="https://github.com/yahoo/bullet-docs/blob/master/examples/storm/src/main/java/com/yahoo/bullet/storm/examples/RandomSpout.java">custom spout code</a> that generates the data.</p>
<pre><code class="java">    @Override
    public void nextTuple() {
        long timeNow = System.nanoTime();
        // Only emit if we are still in the interval and haven't gone over our per period max
        if (timeNow &lt;= nextIntervalStart &amp;&amp; generatedThisPeriod &lt; maxPerPeriod) {
            outputCollector.emit(new Values(generateRecord()), DUMMY_ID);
            generatedThisPeriod++;
        }
        if (timeNow &gt; nextIntervalStart) {
            log.info(&quot;Generated {} tuples out of {}&quot;, generatedThisPeriod, maxPerPeriod);
            nextIntervalStart = timeNow + period;
            generatedThisPeriod = 0;
            periodCount++;
        }
        // It is courteous to sleep for a short time if you're not emitting anything...
        try {
            Thread.sleep(1);
        } catch (InterruptedException e) {
            log.error(&quot;Error: &quot;, e);
        }
    }
</code></pre>

<p>This method above emits the tuples. The Storm framework calls this method. This function only emits at most the given maximum tuples per period.</p>
<div class="admonition note">
<p class="admonition-title">Why a DUMMY_ID?</p>
<p>When the spout emits the randomly generated tuple, it attaches a <code>DUMMY_ID</code> to it. In Storm terms, this is a message ID. By adding a message ID, this tuple can be made to flow reliably. The Bullet component that receives this tuple (Filter bolt) acknowledges or "acks" this tuple. If the tuple did not make it to Filter bolt within a configured timeout window, Storm will call a <code>fail(Object messageId)</code> method on the spout. This particular spout does not define one and hence the usage of a <code>DUMMY_ID</code>. If your source of data can identify records uniquely and you can re-emit them on a fail, you should attach that actual ID in place of the <code>DUMMY_ID</code>.</p>
</div>
<pre><code class="java">    private BulletRecord generateRecord() {
        BulletRecord record = new BulletRecord();
        String uuid = UUID.randomUUID().toString();

        record.setString(STRING, uuid);
        record.setLong(LONG, (long) generatedThisPeriod);
        record.setDouble(DOUBLE, random.nextDouble());

        Map&lt;String, Boolean&gt; booleanMap = new HashMap&lt;&gt;(4);
        booleanMap.put(uuid.substring(0, 8), random.nextBoolean());
        booleanMap.put(uuid.substring(9, 13), random.nextBoolean());
        booleanMap.put(uuid.substring(14, 18), random.nextBoolean());
        booleanMap.put(uuid.substring(19, 23), random.nextBoolean());
        record.setBooleanMap(BOOLEAN_MAP, booleanMap);

        STATS_MAP_VALUE.put(PERIOD_COUNT, periodCount);
        STATS_MAP_VALUE.put(RECORD_NUMBER, periodCount * maxPerPeriod + generatedThisPeriod);
        STATS_MAP_VALUE.put(NANO_TIME, System.nanoTime());
        STATS_MAP_VALUE.put(TIMESTAMP, System.currentTimeMillis());
        record.setLongMap(STATS_MAP, STATS_MAP_VALUE);

        RANDOM_MAP_VALUE_A.put(RANDOM_MAP_KEY_A, STRING_POOL[random.nextInt(STRING_POOL.length)]);
        RANDOM_MAP_VALUE_A.put(RANDOM_MAP_KEY_B, STRING_POOL[random.nextInt(STRING_POOL.length)]);
        RANDOM_MAP_VALUE_B.put(RANDOM_MAP_KEY_A, STRING_POOL[random.nextInt(STRING_POOL.length)]);
        RANDOM_MAP_VALUE_B.put(RANDOM_MAP_KEY_B, STRING_POOL[random.nextInt(STRING_POOL.length)]);
        record.setListOfStringMap(LIST, asList(RANDOM_MAP_VALUE_A, RANDOM_MAP_VALUE_B));

        return record;
    }
</code></pre>

<p>This method generates some fields randomly and inserts them into a BulletRecord. Note that the BulletRecord is typed and all data must be inserted with the proper types. If you put Bullet on your data, you will need to write a Spout (or a topology if your reading is complex), that reads from your data source and emits BulletRecords with the fields you wish to be queryable placed into a BulletRecord.</p>
<div class="admonition note">
<p class="admonition-title">Reusing Maps?</p>
<p>There is no need to reuse maps. This example tries to be as efficient as possible in order to allow variable throughputs.</p>
</div>
<h3 id="web-service">Web Service</h3>
<p>We launched the Web Service using two custom files - a properties file and JSON schema file.</p>
<p>The JSON columns file contains the schema for our data specified in JSON. Since our schema is not going to change, we use the Web Service to serve it from a file. If your schema changes dynamically, you will need to provide your own endpoint to the UI.</p>
<p>The following is a snippet from the <a href="https://github.com/yahoo/bullet-docs/blob/master/examples/web-service/example_columns.json">JSON file</a>. Notice how the types of the fields are specified. Also, if you have generated BulletRecord with Map fields whose keys are known, you can specify them here using <code>enumerations</code>.</p>
<pre><code class="javascript">[
    {
        &quot;name&quot;: &quot;probability&quot;,
        &quot;type&quot;: &quot;DOUBLE&quot;,
        &quot;description&quot;: &quot;Generated from Random#nextDouble&quot;
    },
    ...
    {
        &quot;name&quot;: &quot;stats_map&quot;,
        &quot;type&quot;: &quot;MAP&quot;,
        &quot;subtype&quot;: &quot;LONG&quot;,
        &quot;description&quot;: &quot;This map contains some numeric information such as the current number of periods etc.&quot;,
        &quot;enumerations&quot;: [
            ...
            {&quot;name&quot;: &quot;nano_time&quot;, &quot;description&quot;: &quot;The ns time when this record was generated&quot;}
        ]
    },
    {
        &quot;name&quot;: &quot;classifiers&quot;,
        &quot;type&quot;: &quot;LIST&quot;,
        &quot;subtype&quot;: &quot;MAP&quot;,
        &quot;description&quot;: &quot;This contains two maps, each with: field_A and field_B whose values are randomly chosen from: foo, bar, baz, qux, quux, norf&quot;
    }
]
</code></pre>

<p>The <a href="https://github.com/yahoo/bullet-docs/blob/master/examples/web-service/example_context.properties">example properties file</a> points to the DRPC host, port, and path as well points to the custom columns file.</p>
<pre><code>drpc.servers=localhost
drpc.port=3774
drpc.path=drpc/bullet
drpc.retry.limit=3
drpc.connect.timeout=1000
columns.file=example_columns.json
columns.schema.version=1.0
</code></pre>

<p><code>drpc.servers</code> is a CSV entry that contains the various DRPC servers in your Storm cluster. If you visit the Storm UI and search in the <code>Nimbus Configuration</code> section, you can find the list of DRPC servers for your cluster. Similarly, <code>drpc.port</code> in the properties file is <code>drpc.http.port</code> in <code>Nimbus Configuration</code>. The <code>drpc.path</code> is the constant string <code>drpc/</code> followed by the value of the <code>topology.function</code> setting in bullet_settings.yaml.</p>
<h3 id="ui">UI</h3>
<p>Finally, we configured the UI with the custom environment specific settings file. We did not add any environments since we only had the one.</p>
<pre><code class="javascript">{
  &quot;default&quot;: {
    &quot;drpcHost&quot;: &quot;http://localhost:9999&quot;,
    &quot;drpcNamespace&quot;: &quot;bullet-service/api&quot;,
    &quot;drpcPath&quot;: &quot;drpc&quot;,
    &quot;schemaHost&quot;: &quot;http://localhost:9999&quot;,
    &quot;schemaNamespace&quot;: &quot;bullet-service/api&quot;,
    &quot;helpLinks&quot;: [
      {
        &quot;name&quot;: &quot;Example Docs Page&quot;,
        &quot;link&quot;: &quot;&quot;
      }
    ],
    &quot;bugLink&quot;: &quot;https://github.com/yahoo/bullet-ui/issues&quot;,
    &quot;aggregateDataDefaultSize&quot;: 512,
    &quot;modelVersion&quot;: 1
  }
}
</code></pre>

<p>Since we served our schema through the same Web Service as our queries, both these point to our Web Service. Note that there is no <code>schemaPath</code> because it must be the constant string <code>columns</code>. If you define a custom endpoint for your schema, you must ensure that it can be obtained by making a GET request to <code>schemaHost/schemaNamespace/columns</code>.</p></div>
        
    </div>

    <footer class="col-md-12" >
        <hr />
        <div class="pull-left col-md-6">
            
            
        </div>
        <div class="pull-right col-md-4 text-right">
            <p>
            <small>Bullet is licensed under the <a href='https://github.com/yahoo/bullet/blob/master/LICENSE'>Apache 2 license<br></small>
            
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
        </div>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
